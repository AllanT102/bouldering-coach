Metadata-Version: 2.4
Name: boulder-coach
Version: 0.1.0
Summary: Analyze bouldering form from MP4 videos
Requires-Python: >=3.9
Description-Content-Type: text/markdown
Requires-Dist: mediapipe
Requires-Dist: opencv-python
Requires-Dist: numpy
Requires-Dist: google-genai
Requires-Dist: pillow
Requires-Dist: onnxruntime

# Boulder Coach

Analyze bouldering form from an MP4 video using pose estimation. The tool generates an annotated video, per-frame metrics, and a summary report.

## What it does
- Detects body pose per frame
- Computes basic climbing form metrics (joint angles, shoulder/hip tilt, reach ratio)
- Writes annotated MP4 and metrics CSV/JSON
- Optional: route-only hold capture with Gemini grip analysis

## Quick start
1. Install dependencies
2. Run the analyzer

### Install
Use your preferred environment manager, then install:
- mediapipe
- opencv-python
- numpy

Or install the project in editable mode:
```
python -m pip install -e .
```

### Run
```
python -m boulder_coach.cli --input /path/to/video.mp4 --output /path/to/output
```

### Route-only hold analysis with Gemini
Provide a route mask image where route holds are white and the rest is black.
If you omit `--route-mask`, the tool will auto-detect the route by tracking wrist contact points.
Set `GEMINI_API_KEY` in your environment to enable Gemini.
Default Gemini model: `models/gemini-flash-latest` (override with `--gemini-model`).

### Local grip classifier (ONNX)
You can run a local image-based classifier on hand/hold crops using an ONNX model and labels file.
The labels file should list grip classes, one per line (e.g., `open_hand`, `half_crimp`, `full_crimp`, `pinch`).

```
python -m boulder_coach.cli \
	--input /path/to/video.mp4 \
	--output /path/to/output \
	--local-grip-model /path/to/grip_model.onnx \
	--local-grip-labels /path/to/labels.txt
```

```
python -m boulder_coach.cli \
	--input /path/to/video.mp4 \
	--output /path/to/output \
	--route-mask /path/to/route_mask.png \
	--gemini \
	--gemini-every-n 10 \
	--gemini-max-calls 5
```

Optional expected grip map (JSON):
```
{
	"edge": "open_hand",
	"sloper": "open_hand",
	"pinch": "pinch"
}
```
Pass it with `--expected-grip-map /path/to/expected_grip.json`.

## Outputs
- annotated.mp4
- metrics.csv
- summary.json
- grip_analysis.json (when Gemini is enabled)
